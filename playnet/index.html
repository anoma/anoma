<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Playnet - Anoma - Technical Specifications</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../assets/custom.css">
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../explore/index.html"><strong aria-hidden="true">2.</strong> Exploration</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../explore/design/index.html"><strong aria-hidden="true">2.1.</strong> Design</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../explore/design/overview.html"><strong aria-hidden="true">2.1.1.</strong> Overview</a></li><li class="chapter-item expanded "><a href="../explore/design/gossip.html"><strong aria-hidden="true">2.1.2.</strong> Gossip network</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../explore/design/intent_gossip/intent_gossip.html"><strong aria-hidden="true">2.1.2.1.</strong> Intent gossip</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../explore/design/intent_gossip/intent.html"><strong aria-hidden="true">2.1.2.1.1.</strong> intent</a></li><li class="chapter-item expanded "><a href="../explore/design/intent_gossip/topic.html"><strong aria-hidden="true">2.1.2.1.2.</strong> topic</a></li><li class="chapter-item expanded "><a href="../explore/design/intent_gossip/incentive.html"><strong aria-hidden="true">2.1.2.1.3.</strong> incentive</a></li><li class="chapter-item expanded "><a href="../explore/design/intent_gossip/matchmaker.html"><strong aria-hidden="true">2.1.2.1.4.</strong> matchmaker</a></li><li class="chapter-item expanded "><a href="../explore/design/intent_gossip/fungible_token.html"><strong aria-hidden="true">2.1.2.1.5.</strong> fungible token</a></li></ol></li><li class="chapter-item expanded "><a href="../explore/design/dkg.html"><strong aria-hidden="true">2.1.2.2.</strong> Distributed key generation gossip</a></li></ol></li><li class="chapter-item expanded "><a href="../explore/design/ledger.html"><strong aria-hidden="true">2.1.3.</strong> The ledger</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../explore/design/ledger/parameters.html"><strong aria-hidden="true">2.1.3.1.</strong> Parameters</a></li><li class="chapter-item expanded "><a href="../explore/design/ledger/epochs.html"><strong aria-hidden="true">2.1.3.2.</strong> Epochs</a></li><li class="chapter-item expanded "><a href="../explore/design/ledger/accounts.html"><strong aria-hidden="true">2.1.3.3.</strong> Accounts</a></li><li class="chapter-item expanded "><a href="../explore/design/ledger/vp.html"><strong aria-hidden="true">2.1.3.4.</strong> Validity predicates</a></li><li class="chapter-item expanded "><a href="../explore/design/ledger/tx.html"><strong aria-hidden="true">2.1.3.5.</strong> Transactions</a></li><li class="chapter-item expanded "><a href="../explore/design/ledger/wasm-vm.html"><strong aria-hidden="true">2.1.3.6.</strong> WASM VM</a></li><li class="chapter-item expanded "><a href="../explore/design/ledger/front-running.html"><strong aria-hidden="true">2.1.3.7.</strong> Front-running prevention</a></li><li class="chapter-item expanded "><a href="../explore/design/fractal-scaling.html"><strong aria-hidden="true">2.1.3.8.</strong> Fractal scaling</a></li><li class="chapter-item expanded "><a href="../explore/design/upgrade-system.html"><strong aria-hidden="true">2.1.3.9.</strong> Upgrade system</a></li><li class="chapter-item expanded "><a href="../explore/design/storage.html"><strong aria-hidden="true">2.1.3.10.</strong> Storage</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../explore/design/data-schema.html"><strong aria-hidden="true">2.1.3.10.1.</strong> Data schema</a></li></ol></li><li class="chapter-item expanded "><a href="../explore/design/ledger/pos-integration.html"><strong aria-hidden="true">2.1.3.11.</strong> PoS integration</a></li></ol></li><li class="chapter-item expanded "><a href="../explore/design/crypto-primitives.html"><strong aria-hidden="true">2.1.4.</strong> Crypto primitives</a></li><li class="chapter-item expanded "><a href="../explore/design/actors.html"><strong aria-hidden="true">2.1.5.</strong> Actors</a></li><li class="chapter-item expanded "><a href="../explore/design/pos.html"><strong aria-hidden="true">2.1.6.</strong> Proof of Stake system</a></li></ol></li><li class="chapter-item expanded "><a href="../explore/prototypes/index.html"><strong aria-hidden="true">2.2.</strong> Prototypes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../explore/prototypes/base-ledger.html"><strong aria-hidden="true">2.2.1.</strong> Base ledger</a></li><li class="chapter-item expanded "><a href="../explore/prototypes/gossip-layer.html"><strong aria-hidden="true">2.2.2.</strong> Gossip layer</a></li></ol></li><li class="chapter-item expanded "><a href="../explore/libraries/index.html"><strong aria-hidden="true">2.3.</strong> Libraries &amp; Tools</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">2.3.1.</strong> Cryptography</div></li><li class="chapter-item expanded "><a href="../explore/libraries/network.html"><strong aria-hidden="true">2.3.2.</strong> network</a></li><li class="chapter-item expanded "><a href="../explore/libraries/cli.html"><strong aria-hidden="true">2.3.3.</strong> Command-line interface</a></li><li class="chapter-item expanded "><a href="../explore/libraries/db.html"><strong aria-hidden="true">2.3.4.</strong> Database</a></li><li class="chapter-item expanded "><a href="../explore/libraries/logging.html"><strong aria-hidden="true">2.3.5.</strong> Logging</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.3.6.</strong> Networking</div></li><li class="chapter-item expanded "><a href="../explore/libraries/packaging.html"><strong aria-hidden="true">2.3.7.</strong> Packaging</a></li><li class="chapter-item expanded "><a href="../explore/libraries/serialization.html"><strong aria-hidden="true">2.3.8.</strong> Serialization</a></li><li class="chapter-item expanded "><a href="../explore/libraries/wasm.html"><strong aria-hidden="true">2.3.9.</strong> WASM runtime</a></li><li class="chapter-item expanded "><a href="../explore/libraries/errors.html"><strong aria-hidden="true">2.3.10.</strong> Error handling</a></li></ol></li><li class="chapter-item expanded "><a href="../explore/design/glossary.html"><strong aria-hidden="true">2.4.</strong> Glossary</a></li><li class="chapter-item expanded "><a href="../explore/resources/index.html"><strong aria-hidden="true">2.5.</strong> Resources</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../explore/resources/ide.html"><strong aria-hidden="true">2.5.1.</strong> IDE</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../specs/index.html"><strong aria-hidden="true">3.</strong> Specifications</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../specs/overview.html"><strong aria-hidden="true">3.1.</strong> Overview</a></li><li class="chapter-item expanded "><a href="../specs/ledger.html"><strong aria-hidden="true">3.2.</strong> The ledger</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.</strong> Trade system</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.4.</strong> Intent gossip system</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.5.</strong> Fractal scaling</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.</strong> Upgrade system</div></li><li class="chapter-item expanded "><a href="../specs/encoding.html"><strong aria-hidden="true">3.7.</strong> Encoding</a></li></ol></li><li class="chapter-item expanded "><a href="../playnet/index.html" class="active"><strong aria-hidden="true">4.</strong> Playnet</a></li><li class="chapter-item expanded "><a href="../archive/index.html"><strong aria-hidden="true">5.</strong> Archive</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../archive/domain-name-addresses.html"><strong aria-hidden="true">5.1.</strong> Domain name addresses</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Anoma - Technical Specifications</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="playnet"><a class="header" href="#playnet">Playnet</a></h1>
<p>üïπüéÆüëæ Welcome to the very first Anoma testnet and thank you for joining us! üïπüéÆüëæ</p>
<p>The main goals of this testnet is to try out some of the functionality of the ledger, intent gossip and the matchmaker and to get some early feedback on its current state. To give feedback, ask questions and report issues, please use the #playnet Slack channel. Many issues and limitations are well known and our test coverage is currently very low, so please excuse Anoma while it is rough around the edges.</p>
<p>You can interact with Anoma via transactions, validity predicates and intents turned into transactions by the matchmaker. Because we don't have a proper wallet yet, each of us will have a pre-generated account address and a wallet key on the genesis block. Because all the keys are public, please respect others' keys and do not use them to sign stuff :)</p>
<h2 id="-install"><a class="header" href="#-install">üíæ Install</a></h2>
<p>You can either use the pre-built binaries we've released on Github or build from source. If you'll want to customize any of the wasm code (transactions, validity predicates and/or matchmaker), we recommend that you build from source to have the source available.</p>
<h3 id="pre-built-binaries"><a class="header" href="#pre-built-binaries">Pre-built binaries</a></h3>
<p>We have built for Mac (darwin_amd64) and Linux (linux_amd64). If you're not on one of these, you'll have to build from the source.</p>
<p>Download the release for your platform from <a href="https://github.com/anoma/anoma/releases">https://github.com/anoma/anoma/releases</a>. They are packaged with Tendermint, which will be used by the Anoma node.</p>
<pre><code class="language-shell"># Extract the archive
tar -xf anoma_0.1_darwin_amd64.tar.gz

cd anoma

# Add the executables to your $PATH
export PATH=&quot;$(pwd):$PATH&quot;
</code></pre>
<p>And you're ready to go!</p>
<h3 id="build-from-the-source"><a class="header" href="#build-from-the-source">Build from the source</a></h3>
<pre><code class="language-shell"># Clone the repo
git clone https://github.com/anoma/anoma.git
# or
git clone git@github.com:anoma/anoma.git

cd anoma

# Checkout the release branch
git checkout v0.1-playnet

# Build and link the executables
make install
</code></pre>
<p>You'll also need to install Tendermint v0.34.* and have it available on your $PATH, e.g.:</p>
<pre><code class="language-shell">apt install tendermint
nix-env -i tendermint
</code></pre>
<p>Or you can get it from <a href="https://github.com/tendermint/tendermint/releases">https://github.com/tendermint/tendermint/releases</a>.</p>
<p>To modify and build any of the wasm source codes:</p>
<pre><code># Run this first if you don't have Rust wasm target installed:
make -C txs/tx_template deps

# If you modify e.g. the transaction template (txs/template/src/lib.rs), you can build it with
make -C txs/tx_template
</code></pre>
<h2 id="-addresses"><a class="header" href="#-addresses">üìá Addresses</a></h2>
<p>The following are the addresses that we have included in the genesis block. You can add them to your shell to use them in commands. You should be able to find your own address among them:</p>
<pre><code class="language-shell"># User addresses
export adrian=a1qq5qqqqqxgeyzdeng4zrw33sxez5y3p3xqerz3psx5e5x32rg3rryw2ygc6yy3p4xpq5gvfnw3nwp8
export alberto=a1qq5qqqqq8yerw3jxx565y333gfpnjwzygcc5zd6xxarr2dzzgcm5xv3kxazrjve589p5vv34vl0yy3
export ash=a1qq5qqqqqxue5vs69xc6nwvfcgdpyy3pnxv6rxw2zx3zryv33gyc5xdekxaryydehgvunsvzz2hjedu
export awa=a1qq5qqqqqg565zv34gcc52v3nxumr23z9gezrj3pnx56rwse4xc6yg3phgcun2d33xyenqv2x4xyw62
export celso=a1qq5qqqqq8qmrwsjyxcerqwzpx9pnzve3gvc5xw29gdqnvv2yx5mrvsjpxgcrxv6pg5engvf5hgjscj
export chris=a1qq5qqqqqgye5xwpcxqu5z3p4g5ens3zr8qm5xv69xfznvwzzx4p5xwpkxc6n2v6x8yc5gdpeezdqc4
export gabriella=a1qq5qqqqq8ycn2djrxqmnyd3sxcunsv2zgyeyvwzpgceyxdf3xyu5gv2pgeprxdfe8ycrzwzzkezpcp
export gianmarco=a1qq5qqqqq89prqsf38qcrzd6zxym5xdfjg4pyg3pjg3pyx32zg5u5y3jpgc65zdej8pznwwf3jqzsws
export joe=a1qq5qqqqqgvuyv335g9z5v32xgdz523zxgsuy23fjxazrjve5g4pnydphxyu5v33cxarrzd692045xh
export nat=a1qq5qqqqq89rygsejx9q5yd6pxpp5x3f38ymyydp3xcu523zzx4prw3fc8qu5vvjpxyeyydpnfha6qt
export simon=a1qq5qqqqqgfqnqdecxcurq33hxcey2sf4g5mygdjyxfrrjse4xyc52vpjxyenwve4gv6njsecz4tzen
export sylvain=a1qq5qqqqqgccnyvp3gyergvp5xgmr2s3s8yung3f4gdq52wzpxvurysfhgycnwd29xfryxvekfwc00t
export tomas=a1qq5qqqqqggcrzsfj8ym5g3psxuurxv2yxseyxwpsxdpy2s35gsc5zdzpx9pyxde48ppnqd3cnzlava
export yuji=a1qq5qqqqqgvcrz3f5x4prssj9x5enydecxfznzdj9g5cnj3fcxarrxdjpx5cnwv69xye5vvfeva4z85

# Token Addresses
export XAN=a1qq5qqqqqxuc5gvz9gycryv3sgye5v3j9gvurjv34g9prsd6x8qu5xs2ygdzrzsf38q6rss33xf42f3
export BTC=a1qq5qqqqq8q6yy3p4xyurys3n8qerz3zxxeryyv6rg4pnxdf3x3pyv32rx3zrgwzpxu6ny32r3laduc
export ETH=a1qq5qqqqqxeryzvjxxsmrj3jpxapygve58qerwsfjxaznvd3n8qenyv2ygsc52335xue5vve5m66gfm
export XTZ=a1qq5qqqqqx3z5xd3ngdqnzwzrgfpnxd3hgsuyx3phgfry2s3kxsc5xves8qe5x33sgdprzvjptzfry9
export DOGE=a1qq5qqqqqx9rrq3zrg5myzv3eg9zyxvf3gery2dfhgg6nsdjrxscrgv6rgsunx33sxg6nvdjrkujezz
</code></pre>
<h2 id="-the-nodes"><a class="header" href="#-the-nodes">·ç® The nodes</a></h2>
<p>There are 4 ledger validator and intent gossip nodes running in cloud at:</p>
<ul>
<li><code>52.210.23.30</code></li>
<li><code>63.34.55.152</code></li>
<li><code>54.195.72.213</code></li>
<li><code>79.125.112.218</code></li>
</ul>
<p>The ledger is pre-configured to connect to them.</p>
<p>To run a local ledger node:</p>
<pre><code class="language-shell">anoma run-ledger
</code></pre>
<p>To run the intent gossip with the matchmaker that can submit transactions to the local ledger:</p>
<pre><code class="language-shell">anoma run-gossip --rpc &quot;127.0.0.1:20202&quot; \
  --matchmaker-path matchmaker_template/matchmaker.wasm \
  --tx-code-path txs/tx_from_intent/tx.wasm \
  --ledger-address &quot;127.0.0.1:26657&quot;
</code></pre>
<p>If you don't have a local ledger running, the matchmaker can also submit transactions to a remote validator ledger, with e.g.:</p>
<pre><code class="language-shell">anoma run-gossip --rpc &quot;127.0.0.1:20202&quot; \
  --matchmaker-path matchmaker_template/matchmaker.wasm \
  --tx-code-path txs/tx_from_intent/tx.wasm \
  --ledger-address &quot;52.210.23.30:26657&quot;
</code></pre>
<h2 id="-wasm"><a class="header" href="#-wasm">üßÆ WASM</a></h2>
<p>Currently, Anoma only supports wasm built from Rust code. This is used for validity predicates, transactions' code, matchmaker's logic and matchmaker's intent filter. We provide a prelude with functions specialized for each of these environments. Additionally, any library code that you may attempt to use in wasm has to be able to compile to wasm, which means no foreign function interface (e.g. C dependencies).</p>
<p>Because wasm doesn't have any built-in logging facilities nor access to stdout, trying to print from wasm has no effect. Instead, we provide <code>log_string</code> function in the wasm environment preludes. When the wasm is being executed, this will be printed from the node's log (search for <code>WASM Transaction log</code>, <code>WASM Validity predicate log</code> or <code>WASM Matchmaker log</code>). You can use the Rust's <code>format!</code> macro for the string that you want to print. Because we don't yet have an RPC client, this in combination with transactions' <code>--dry-run</code> flag is the best way to query the ledger's state.</p>
<p>To view the full list of functions available in wasm, please refer to:</p>
<ul>
<li><a href="https://heliaxdev.github.io/anoma-playnet/doc/anoma_vm_env/tx_prelude/index.html">Transaction prelude</a></li>
<li><a href="https://heliaxdev.github.io/anoma-playnet/doc/anoma_vm_env/vp_prelude/index.html">Validity predicate prelude</a></li>
<li><a href="https://heliaxdev.github.io/anoma-playnet/doc/anoma_vm_env/matchmaker_prelude/index.html">Matchmaker prelude</a></li>
</ul>
<h2 id="-validity-predicates"><a class="header" href="#-validity-predicates">‚òëÔ∏è Validity predicates</a></h2>
<p>Your account will be instantiated with a validity predicate built from the source code of <code>vps/vp_user/src/lib.rs</code> and a public key. This VP allows:</p>
<ul>
<li>for anyone to send you a token(s)</li>
<li>for you to send a token(s), which must be authorized by a signature with the key associated with your account</li>
<li>perform any changes to your account's storage, which must also be authorized by a signature</li>
<li>perform transactions created by the matchmaker from intents that were signed by your the key associated with your account</li>
</ul>
<p>You can customize this code and deploy it to the ledger with a transaction described below.</p>
<h2 id="-transactions"><a class="header" href="#-transactions">üì© Transactions</a></h2>
<p>A transaction consists of a wasm code and additional optional arbitrary data bytes. The data will be passed to the transaction as its input when it's being executed on-chain.</p>
<p>Any of the following commands can optionally be submitted with <code>--dry-run</code> argument to simulate transaction's execution without including it in a block.</p>
<h3 id="-a-simple-token-transfer"><a class="header" href="#-a-simple-token-transfer">üí∏ A simple token transfer</a></h3>
<p>To make a transfer of e.g. <code>10.1</code> of a fungible token <code>$XAN</code> from <code>$awa</code> to <code>$joe</code>:</p>
<pre><code class="language-shell">anoma client transfer --source $awa \
  --target $joe \
  --token $XAN \
  --amount 10.1 \
  --code-path txs/tx_transfer/tx.wasm
</code></pre>
<p>This client command will take care of signing the transaction using your key.</p>
<p>To check balances of fungible token, run e.g.:</p>
<pre><code class="language-shell">anoma client balances --address $adrian
</code></pre>
<h3 id="-update-an-accounts-validity-predicate"><a class="header" href="#-update-an-accounts-validity-predicate">‚ôº Update an account's validity predicate</a></h3>
<p>To update an account's validity predicate, you can customize the default user's VP at <code>vps/vp_user/src/lib.rs</code>, or built your own from scratch using <code>vps/vp_template/src/lib.rs</code>. To deploy to, use e.g.:</p>
<pre><code class="language-shell"># Compile the validity predicate
make -C vps/vp_user

# Submit a transaction with the updated VP to the ledger
anoma client update --address $awa --code-path vps/vp_user/vp.wasm
</code></pre>
<h3 id="-a-custom-transaction"><a class="header" href="#-a-custom-transaction">ü¶Ñ A custom transaction</a></h3>
<p>To submit a custom transaction, one can use the <code>txs/tx_template/src/lib.rs</code> to implement the transaction's effects. Optionally, you can attach arbitrary bytes to the transaction from a file with the <code>--data-path</code> argument.</p>
<p>For example:</p>
<pre><code class="language-shell"># Compile the transaction's code from the template
make -C txs/tx_template

# Submit the transaction to the ledger
anoma client tx --code-path txs/tx_template/tx.wasm --data-path tx.data
</code></pre>
<p>This transaction is by default not signed by any key, so if you try to use it make changes to your account's storage, it will be rejected by your validity predicate.</p>
<h2 id="-intents"><a class="header" href="#-intents">‚úã Intents</a></h2>
<p>In general, intents are some data that describe what you'd like to do with your account. We provide a template for intents signed by the source key of the source address, which can describe a desire to trade one of the fungible tokens.</p>
<p>To create a file <code>intent.data</code> with the intent's data, use e.g.:</p>
<pre><code class="language-shell">anoma client craft-intent --address $awa \
  --token-buy $XTZ \
  --amount-buy 10 \
  --token-sell $BTC \
  --amount-sell 20 \
  --file-path intent.data
</code></pre>
<p>To submit the intent from the file to the intent gossip (which will propagate to matchmakers):</p>
<pre><code class="language-shell"># Without a local intent gossip node, using one of the cloud nodes
anoma client intent --node &quot;http://52.210.23.30:20202&quot; \
  --data-path intent.data \
  --topic &quot;asset_v0&quot;

# With a local intent gossip node
anoma client intent --node &quot;http://127.0.0.1:20202&quot; \
  --data-path intent.data \
  --topic &quot;asset_v0&quot;
</code></pre>
<p>Once a matchmaker finds suitable matches of intents that it decides are likely to be accepted, it will try to submit a transaction to a connected ledger.</p>
<p>For now, to match intents, their amounts have to match exactly. In future, there will more options on how intents can be specified and matched.</p>
<h2 id="-matchmaker"><a class="header" href="#-matchmaker">ü§ù Matchmaker</a></h2>
<p>The provide matchmaker's code tries to match intents using a graph of intents in the format described above constructed with Tarjan's algorithm, but it also allows for you to write your own! The source code to the matchmaker is at <code>matchmaker_template/src/lib.rs</code>. To customize the transaction's code that is used to submit transactions from matched intent, you can update <code>txs/tx_from_intent/src/lib.rs</code>.</p>
<pre><code># build the matchmaker's code
make -C matchmaker_template

# build the matchmaker's transaction's code
make -C txs/tx_from_intent
</code></pre>
<p>And then restart the intent gossip with the matchmaker.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../specs/encoding.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../archive/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../specs/encoding.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../archive/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../assets/mermaid.min.js"></script>
        <script type="text/javascript" src="../assets/mermaid-init.js"></script>
    </body>
</html>
